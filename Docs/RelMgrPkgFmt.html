<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1252">
<META NAME="Generator" CONTENT="Microsoft Word 97">
<TITLE>Package Format for the IMSS Release Manager System</TITLE>
<META NAME="Template" CONTENT="C:\data\ms\template\Quirks.dot">
</HEAD>
<BODY>

<B><FONT FACE="Arial" SIZE=4><P>Package Format for the IMSS Release Manager System</P>
</B></FONT><FONT SIZE=2><P>Last updated:&#9;12/22/98 1:46 PM</P>
</FONT><B><FONT FACE="Arial"><P>Purpose and Scope</P>
</B></FONT><FONT SIZE=2><P>This document is intended to provide a basic guide to the format of archival packages in the context of the IMSS Release Management System. The packages are manipulated and deployed on servers by the components of the <I>Release Management System</I>, described elsewhere. Ordinarily these packages are assembled and transmitted to the servers by tools developed within IMSS specifically designed for that purpose. However, changes in the way web sites are developed and maintained call for extended ability to deploy content from hosts outside of IMSS, and it is for this purpose that this document explains the structure of the release packages.</P>
</FONT><B><FONT FACE="Arial"><P>Package Format and Contents</P>
</B></FONT><FONT SIZE=2><P>The packages are distributed in the UNIX &quot;tar&quot; (tape archive) format. The <B>tar</B> application is commonplace on UNIX systems and should be present on any version of the UNIX operating system. There are also applications available for Microsoft platforms that can generate the format.</P>
<P>The important issue is in the archive’s contents and their directory structure. For these examples, assume a project exists that is named &quot;</FONT><FONT FACE="Courier New" SIZE=2>test</FONT><FONT SIZE=2>&quot;. Note that there are no restrictions on the name of the archive itself—when received by the release manager server it is assigned a name at that point.</P>
<P>All of the file paths in the archive must start with the designated project name. Contents of a project are kept under that name in the development area on internal development servers, and the files are deployed to an area of the web server document tree that also uses that name. For example:</P>
<P>&#9;</FONT><FONT FACE="Courier New" SIZE=2>test/image.gif</P>
<P>&#9;test/index.html</P>
<P>&#9;test/weblist</P>
</FONT><FONT SIZE=2><P>This archive contains three files. All three files are under the directory name that corresponds to the project. The third file name is of particular interest. It is a special file used by the release management system for task of validating and deploying the content. More will be discussed concerning the &quot;</FONT><FONT FACE="Courier New" SIZE=2>weblist</FONT><FONT SIZE=2>&quot; file later.</P>
<P>When a package is release for a project—whether by the developer tools, the web-form or a scripted solution developed by external agencies, it has the project name associated with it. That project name must correspond to the top-level directory in the archive. The above three-file archive could not be used with a project name of &quot;</FONT><FONT FACE="Courier New" SIZE=2>imss</FONT><FONT SIZE=2>&quot;, as that would not match the contents of the archive.</P>
<P>At present, the archive must be provided in an uncompressed, unencrypted form. Support of compression (specifically LZW and Zlib, the algorithms of the UNIX </FONT><FONT FACE="Courier New" SIZE=2>compress</FONT><FONT SIZE=2> and </FONT><FONT FACE="Courier New" SIZE=2>gzip</FONT><FONT SIZE=2> utilities respectively) is in the planning stage. Also in the design stage is support for encrypted transmission, using either SSL via the web server, or existing algorithms such as IDEA or DES, possibly public-key algorithms, as well. At this time, the potential benefits of encrypted transmission have not been demonstrated, so the effort is more focused on compression of the data so as to shorten transmission time.</P>
</FONT><B><FONT FACE="Arial"><P>The Special File </FONT><FONT FACE="Courier New">weblist</P>
</B></FONT><I><FONT SIZE=2><P>Important note: this file’s format description applies only to IMSS-managed release servers. The software in use by the corporate site (</FONT><FONT FACE="Courier New" SIZE=2>www.hp.com</FONT><FONT SIZE=2>) is different, and the format of their contents listing is different. It is also called &quot;</FONT><FONT FACE="Courier New" SIZE=2>Weblist</FONT><FONT SIZE=2>&quot;, with a capital.</P>
</I><P>The weblist file is essentially the manifest, or table of contents, for the project being released. Each line that is not a blank or a comment refers to one file in the project. It is either deployment information for files that are new or being updated, or it is a deletion directive for those files that have been removed or made obsolete in the project.</P>
<P>Using the sample </FONT><FONT FACE="Courier New" SIZE=2>weblist</FONT><FONT SIZE=2> shown below:</P>
</FONT><FONT FACE="Courier New" SIZE=2><P># test/weblist - written by stage for randyr</P>
<P>Doc     index.html      /test</P>
<P>Fig     test.gif        /test</P>
<P>Mp2     test.map        /test</P>
<P>Doc     test1.html      /test</P>
<P>Doc     test2.html      /test</P>
</FONT><FONT SIZE=2><P>The first line is a comment. These are lines whose first non-whitespace character is a hash mark (&quot;</FONT><FONT FACE="Courier New" SIZE=2>#</FONT><FONT SIZE=2>&quot;). These lines, as well as blank lines, are ignored when processing the package contents.</P>
<P>The remaining lines each consist of three parts: a <I>type</I>, a <I>source</I>, and a <I>destination</I>.</P>
</FONT><B><FONT FACE="Arial" SIZE=2><P>The </FONT><FONT FACE="Courier New" SIZE=2>type</FONT><FONT FACE="Arial" SIZE=2> Field</P>
</B></FONT><FONT SIZE=2><P>This field is used primarily to distinguish executable content from non-executable. Only the value of &quot;</FONT><FONT FACE="Courier New" SIZE=2>Bin</FONT><FONT SIZE=2>&quot; is significant (and letter-case is not significant). Files with a type set to &quot;</FONT><FONT FACE="Courier New" SIZE=2>Bin</FONT><FONT SIZE=2>&quot; are given different access permissions. They receive </FONT><FONT FACE="Courier New" SIZE=2>read</FONT><FONT SIZE=2> and </FONT><FONT FACE="Courier New" SIZE=2>execute</FONT><FONT SIZE=2> permission, whereas other files receive </FONT><FONT FACE="Courier New" SIZE=2>read</FONT><FONT SIZE=2> permission only. The existing permissions on the file that are recorded in the archive do not matter.</P>
<P>The remaining types are currently for informative use only. They could become significant should the architecture of the web hosts change such that images and HTML were to be treated differently. For now, the only other values in use are: &quot;</FONT><FONT FACE="Courier New" SIZE=2>Map</FONT><FONT SIZE=2>&quot; or &quot;</FONT><FONT FACE="Courier New" SIZE=2>Mp2</FONT><FONT SIZE=2>&quot; for files ending in &quot;</FONT><FONT FACE="Courier New" SIZE=2>.map</FONT><FONT SIZE=2>&quot; which are treated as image maps, &quot;</FONT><FONT FACE="Courier New" SIZE=2>Doc</FONT><FONT SIZE=2>&quot; for files that are HTML, and &quot;</FONT><FONT FACE="Courier New" SIZE=2>Fig</FONT><FONT SIZE=2>&quot; for everything else. The only other type that is handled specially is &quot;</FONT><FONT FACE="Courier New" SIZE=2>OBS</FONT><FONT SIZE=2>&quot;: this indicates a file that is no longer in use, and should therefore be deleted from the server. If the file does not exist (likely due to having already been specified as </FONT><FONT FACE="Courier New" SIZE=2>OBS</FONT><FONT SIZE=2> at least once before), no error is reported, it is simply passed over.</P>
<P>Support for Java servlets and applets is currently being designed. The type identifier for these will likely be &quot;</FONT><FONT FACE="Courier New" SIZE=2>Jvs</FONT><FONT SIZE=2>&quot; for servlets and &quot;</FONT><FONT FACE="Courier New" SIZE=2>Jva</FONT><FONT SIZE=2>&quot; for applets. However, as this is still in the design phase, these should not be used in any weblist files just yet.</P>
</FONT><B><FONT FACE="Arial" SIZE=2><P>The </FONT><FONT FACE="Courier New" SIZE=2>source</FONT><FONT FACE="Arial" SIZE=2> Field</P>
</B></FONT><FONT SIZE=2><P>The second field specifies where the file is located in the archive area. The path is assumed to be relative to the project name, since the project name is already a given part of the archive structure. The first line in the sample weblist has a second field of simply &quot;</FONT><FONT FACE="Courier New" SIZE=2>index.html</FONT><FONT SIZE=2>&quot;. Given that the project in this example is &quot;</FONT><FONT FACE="Courier New" SIZE=2>test</FONT><FONT SIZE=2>&quot;, the actual path of the file in the archive is &quot;</FONT><FONT FACE="Courier New" SIZE=2>test/index.html</FONT><FONT SIZE=2>&quot;. However, the leading &quot;</FONT><FONT FACE="Courier New" SIZE=2>test/</FONT><FONT SIZE=2>&quot; part of the path is removed for the weblist, so what is left is just &quot;</FONT><FONT FACE="Courier New" SIZE=2>index.html</FONT><FONT SIZE=2>&quot;. Though there are no CGI examples in the sample weblist, there are several considerations when dealing with CGI components, covered in a separate section below.</P>
</FONT><B><FONT FACE="Arial" SIZE=2><P>The </FONT><FONT FACE="Courier New" SIZE=2>destination</FONT><FONT FACE="Arial" SIZE=2> Field</P>
</B></FONT><FONT SIZE=2><P>This last field determines where the file should be moved. If the type field specifies a &quot;</FONT><FONT FACE="Courier New" SIZE=2>Bin</FONT><FONT SIZE=2>&quot; file, then the destination path is considered relative to the root of the CGI area for the server. Other file types are considered to be relative to the documents area. The actual definition of these areas is server-specific and not something that the archive or the developers should be concerned with. There are path conventions that apply to CGI content, see below. The destination specification does not include the actual file name, as the release manager via the second field already knows the name. The file is moved into the destination area, then the access permissions are set according to type.</P>
</FONT><B><FONT FACE="Arial"><P>CGI Content and Path Translations</P>
</B></FONT><FONT SIZE=2><P>When files are released as CGI content, they generally undergo some translation in their destination path. This is due to the fact that earlier web hosts were home to several (dozen) separate projects, and as such there needed to be some layer of separation so that two project do not clash over ownership of a name such as &quot;</FONT><FONT FACE="Courier New" SIZE=2>mailform.pl</FONT><FONT SIZE=2>&quot; or similar. Hosts that have been set up more recently make use of virtual hosting to associate a unique web address with a single project. For them, the CGI translation is optional.</P>
<P>The basic approach to the translation has been geared towards swapping the position of the sequences &quot;</FONT><FONT FACE="Courier New" SIZE=2>cgi-bin</FONT><FONT SIZE=2>&quot; and the actual project name. Within CVS repositories, a project’s CGI area falls as a sub-directory under the main project directory. When deployed to an external host, however, the CGI area is based from a single &quot;</FONT><FONT FACE="Courier New" SIZE=2>cgi-bin</FONT><FONT SIZE=2>&quot; directory in which project-specific directories are placed. To achieve this, the following translations are made on the <I>destination</I> paths in the </FONT><FONT FACE="Courier New" SIZE=2>weblist</FONT><FONT SIZE=2> file for all items of type &quot;</FONT><FONT FACE="Courier New" SIZE=2>bin</FONT><FONT SIZE=2>&quot;:</P>

<UL>

<UL>
<LI>If the target host is &quot;</FONT><FONT FACE="Courier New" SIZE=2>www.hp.com</FONT><FONT SIZE=2>&quot;, the path is translated per their directory policy.</LI>
<LI>If the target host is exempted from translation, then the leading project name is removed from the path, so that the final value of destination contains only &quot;</FONT><FONT FACE="Courier New" SIZE=2>cgi-bin</FONT><FONT SIZE=2>&quot; without the project name.</LI>
<LI>Lastly, the default action of swapping the project name and the &quot;</FONT><FONT FACE="Courier New" SIZE=2>cgi-bin</FONT><FONT SIZE=2>&quot; path element is done if no other rule has prevented this.</LI></UL>
</UL>

<P>Note that these translations are only done on the <I>destination</I> path value. The result is that the file is still picked up and archived from within the CVS repository as expected, and the <B>release</B> tool manages the final destination for the file based on the host it is being released to.</P>
</FONT><B><FONT FACE="Arial" SIZE=2><P>Creating CGI Entries in </FONT><FONT FACE="Courier New" SIZE=2>weblist</P>
</B></FONT><FONT SIZE=2><P>That having been said, a &quot;</FONT><FONT FACE="Courier New" SIZE=2>Bin</FONT><FONT SIZE=2>&quot; entry in a </FONT><FONT FACE="Courier New" SIZE=2>weblist</FONT><FONT SIZE=2> file is dependent on the target host. For project &quot;</FONT><FONT FACE="Courier New" SIZE=2>test</FONT><FONT SIZE=2>&quot; on host &quot;</FONT><FONT FACE="Courier New" SIZE=2>www.interactive.hp.com</FONT><FONT SIZE=2>&quot;, a CGI script &quot;</FONT><FONT FACE="Courier New" SIZE=2>test.pl</FONT><FONT SIZE=2>&quot; will appear in the list as:</P>
<P>&#9;</FONT><FONT FACE="Courier New" SIZE=2>Bin&#9;cgi-bin/test.pl&#9;/cgi-bin/test</P>
</FONT><FONT SIZE=2><P>Remembering that the <I>source</I> (second field) is already presumed to be relative to &quot;</FONT><FONT FACE="Courier New" SIZE=2>test</FONT><FONT SIZE=2>&quot;, and that <I>destination</I> entries do not need to include the actual filename, the file name transitioned as such:</P>
<P>&#9;</FONT><FONT FACE="Courier New" SIZE=2>/test/cgi-bin/test.pl    # The starting point</P>
</FONT><FONT SIZE=2><P>&#9;</FONT><FONT FACE="Courier New" SIZE=2>/cgi-bin/test/test.pl    # Swap test and cgi-bin</P>
</FONT><FONT SIZE=2><P>&#9;</FONT><FONT FACE="Courier New" SIZE=2>/cgi-bin/test            # Drop the file (leaf) component of path</P>
</FONT><FONT SIZE=2><P>The final value is then used as the third field, with the original path (minus the leading project name) in the second position and the file type in the first position.</P></FONT></BODY>
</HTML>
